# New ETL Pipeline

## Overview

This document describes the datasets used in the pipeline, including their sources, attributes, update frequency, and known issues.

## Data Dictionary

| Column Name                           | Added by Function     | Data Type | Description                                                                          | Function Known Issues                                                             | Source                                                                                                                                                          | Function Description                                                                                                                                                                                                                                                                                                                                                                                                    | Updated by Functions                |
| :------------------------------------ | :-------------------- | :-------- | :----------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------- |
| access_process                        | access_process        | str       | The access process for each property based on city ownership and market value.       |                                                                                   |                                                                                                                                                                 | Process a dataset to determine the access process for each property based on city ownership and market value. The result is added as a new column in the dataset.                                                                                                                                                                                                                                                       |                                     |
| all_violations_past_year              | li_violations         | int       | Total violations in the past year.                                                   |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Process L&I (Licenses and Inspections) data for violations. This function filters and processes L&I violations data, joining it with the primary feature layer based on spatial relationships and OPA (Office of Property Assessment) identifiers.                                                                                                                                                                      |                                     |
| building_code_description             | opa_properties        | str       | The building code description                                                        |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| city_owner_agency                     | city_owned_properties | str       | The agency that owns the city property.                                              |                                                                                   | https://services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/LAMAAssets/FeatureServer/0/                                                                   | Processes city-owned property data by joining it with the primary feature layer, renaming columns, and updating access information for properties based on ownership. All instances where the "city_owner_agency" is "PLB" are changed to "Land Bank (PHDC)".                                                                                                                                                           |                                     |
| conservatorship                       | conservatorship       | str       | Indicates whether each property qualifies for conservatorship ("Yes" or "No").       |                                                                                   |                                                                                                                                                                 | Determines conservatorship eligibility for properties in a feature layer.                                                                                                                                                                                                                                                                                                                                               |                                     |
| dev_rank                              | dev_probability       | str       | The development rank of the census block group.                                      |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Calculates development probability based on permit counts and assigns development ranks to census block groups. The results are joined to the primary feature layer.                                                                                                                                                                                                                                                    |                                     |
| district                              | council_dists         | str       | The council district associated with the property.                                   |                                                                                   |                                                                                                                                                                 | Associates properties in the primary feature layer with council districts using a spatial join.                                                                                                                                                                                                                                                                                                                         |                                     |
| drug_crimes_density                   | drug_crimes           | float     | KDE density of drug crimes.                                                          |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for drug crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                          |                                     |
| drug_crimes_density_label             | drug_crimes           | str       | Categorized density level.                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for drug crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                          |                                     |
| drug_crimes_density_percentile        | drug_crimes           | float     | Percentile rank of density.                                                          |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for drug crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                          |                                     |
| drug_crimes_density_zscore            | drug_crimes           | float     | Z-score of drug crime density.                                                       |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for drug crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                          |                                     |
| geometry                              | opa_properties        | geometry  | The geometry of the property                                                         |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 | pwd_parcels                         |
| gun_crimes_density                    | gun_crimes            | float     | KDE density of gun crimes.                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for gun crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                           |                                     |
| gun_crimes_density_label              | gun_crimes            | str       | Categorized density level.                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for gun crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                           |                                     |
| gun_crimes_density_percentile         | gun_crimes            | float     | Percentile rank of density.                                                          |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for gun crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                           |                                     |
| gun_crimes_density_zscore             | gun_crimes            | float     | Z-score of gun crime density.                                                        |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for gun crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                           |                                     |
| imm_dang_building                     | imm_dang_buildings    | str       | Indicates whether each property is categorized as imminently dangerous ("Y" or "N"). |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds information about imminently dangerous buildings to the primary feature layer by joining with a dataset of dangerous buildings.                                                                                                                                                                                                                                                                                    |                                     |
| is_actionable                         | delinquencies         | str       | Flag for actionable tax delinquency.                                                 |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     |                                     |
| l_and_i_complaints_density            | li_complaints         | float     | KDE density of complaints.                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for L&I complaints to the primary feature layer.                                                                                                                                                                                                                                                                                                                       |                                     |
| l_and_i_complaints_density_label      | li_complaints         | str       | Categorized density level.                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for L&I complaints to the primary feature layer.                                                                                                                                                                                                                                                                                                                       |                                     |
| l_and_i_complaints_density_percentile | li_complaints         | float     | Percentile rank of density.                                                          |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for L&I complaints to the primary feature layer.                                                                                                                                                                                                                                                                                                                       |                                     |
| l_and_i_complaints_density_zscore     | li_complaints         | float     | Z-score of complaint density.                                                        |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Applies kernel density estimation (KDE) analysis for L&I complaints to the primary feature layer.                                                                                                                                                                                                                                                                                                                       |                                     |
| market_value                          | opa_properties        | float     | the market value from the OPA data                                                   |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| most_recent_year_owed                 | delinquencies         | str       | Most recent year owed.                                                               |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     |                                     |
| n_contiguous                          | contig_neighbors      | int       | The number of contiguous vacant neighbors for each property.                         |                                                                                   |                                                                                                                                                                 | Calculates the number of contiguous vacant neighbors for each property in a feature layer.                                                                                                                                                                                                                                                                                                                              |                                     |
| n_total_properties_owned              | negligent_devs        | int       | Total number of properties owned by the developer                                    |                                                                                   |                                                                                                                                                                 | Identifies negligent developers based on the number of vacant properties owned and flags them in the primary feature layer.                                                                                                                                                                                                                                                                                             |                                     |
| n_vacant_properties_owned             | negligent_devs        | int       | Number of vacant properties owned by the developer                                   |                                                                                   |                                                                                                                                                                 | Identifies negligent developers based on the number of vacant properties owned and flags them in the primary feature layer.                                                                                                                                                                                                                                                                                             |                                     |
| negligent_dev                         | negligent_devs        | bool      | non-city owned entities owning 5+ vacant properties                                  |                                                                                   |                                                                                                                                                                 | Identifies negligent developers based on the number of vacant properties owned and flags them in the primary feature layer.                                                                                                                                                                                                                                                                                             |                                     |
| neighborhood                          | nbhoods               | str       | The name of the neighborhood associated with the property.                           |                                                                                   | https://raw.githubusercontent.com/opendataphilly/open-geo-data/master/philadelphia-neighborhoods/philadelphia-neighborhoods.geojson                             | Adds neighborhood information to the primary feature layer by performing a spatial join with a neighborhoods dataset.                                                                                                                                                                                                                                                                                                   |                                     |
| num_years_owed                        | delinquencies         | int       | Number of years owed.                                                                |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     |                                     |
| opa_id                                | opa_properties        | int       | the OPA ID of the property                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| open_violations_past_year             | li_violations         | int       | Open violations in the past year.                                                    |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Process L&I (Licenses and Inspections) data for violations. This function filters and processes L&I violations data, joining it with the primary feature layer based on spatial relationships and OPA (Office of Property Assessment) identifiers.                                                                                                                                                                      |                                     |
| owner_1                               | opa_properties        | str       | The first owner of the property                                                      |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| owner_2                               | opa_properties        | str       | The second owner of the property                                                     |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| owner_type                            | owner_type            | str       | The ownership type of the property: Public, Business (LLC) or Individual.            |                                                                                   |                                                                                                                                                                 | Determines the ownership type for each property in the primary feature layer based on the 'owner_1', 'owner_2', and 'city_owner_agency' columns. The ownership type is set as: - "Public" if 'city_owner_agency' is not NA. - "Business (LLC)" if 'city_owner_agency' is NA and "LLC" is found in 'owner_1' or 'owner_2'. - "Individual" if 'city_owner_agency' is NA and "LLC" is not found in 'owner_1' or 'owner_2'. |                                     |
| parcel_type                           | opa_properties        | str       | "Land" or "Building"                                                                 |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| park_priority                         | park_priority         | int       | The park priority score.                                                             |                                                                                   | https://www.tpl.org/park-data-downloads                                                                                                                         | Downloads and processes park priority data, then joins it with the primary feature layer.                                                                                                                                                                                                                                                                                                                               |                                     |
| payment_agreement                     | delinquencies         | str       | Indicates if there is a payment agreement.                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     |                                     |
| permit_count                          | dev_probability       | int       | The number of permits issued in the census block group.                              |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Calculates development probability based on permit counts and assigns development ranks to census block groups. The results are joined to the primary feature layer.                                                                                                                                                                                                                                                    |                                     |
| phs_care_program                      | phs_properties        | str       | The PHS care program associated with the property.                                   |                                                                                   |                                                                                                                                                                 | Perform a spatial join between the primary feature layer and the PHS properties layer, then update the primary feature layer with a new column 'phs_care_program' indicating if the property is part of the PHS care program.                                                                                                                                                                                           |                                     |
| priority_level                        | priority_level        | str       | The priority level ( "Low", "Medium", or "High") of the property                     |                                                                                   | gun_crimes_density_zscore, all_violations_past_year, l_and_i_complaints_density_zscore, tree_canopy_gap, phs_care_program columns in the primary feature layer. | Determines priority levels for properties based on gun crime density, violations, tree canopy gaps, and PHS Landcare status.                                                                                                                                                                                                                                                                                            |                                     |
| rco_info                              | rco_geoms             | str       | Additional RCO-related information.                                                  |                                                                                   | "https://services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/Zoning_RCO/FeatureServer/0/"                                                                 | Adds Registered Community Organization (RCO) information to the primary feature layer by performing a spatial join and aggregating RCO data.                                                                                                                                                                                                                                                                            |                                     |
| rco_names                             | rco_geoms             | str       | Names of RCOs associated with the property.                                          |                                                                                   | "https://services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/Zoning_RCO/FeatureServer/0/"                                                                 | Adds Registered Community Organization (RCO) information to the primary feature layer by performing a spatial join and aggregating RCO data.                                                                                                                                                                                                                                                                            |                                     |
| sale_date                             | opa_properties        | str       | the date of the last sale                                                            |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| sale_price                            | opa_properties        | float     | the price of the last sale                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| sheriff_sale                          | delinquencies         | str       | Indicates if the property is at risk of sheriff sale.                                |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     |                                     |
| side_yard_eligible                    | city_owned_properties | str       | Indicates if the property is eligible for the side yard program.                     |                                                                                   | https://services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/LAMAAssets/FeatureServer/0/                                                                   | Processes city-owned property data by joining it with the primary feature layer, renaming columns, and updating access information for properties based on ownership. All instances where the "city_owner_agency" is "PLB" are changed to "Land Bank (PHDC)".                                                                                                                                                           |                                     |
| standardized_address                  | opa_properties        | str       | A standardized mailing address                                                       |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| tactical_urbanism                     | tactical_urbanism     | str       | Indicates whether each property qualifies for tactical urbanism ("Yes" or "No").     |                                                                                   |                                                                                                                                                                 | Assigns a 'tactical_urbanism' value to each row in the primary feature layer based on specific conditions. Tactical urbanism is marked as "Yes" if the property is a parcel of type 'Land', and does not have any unsafe or immediately dangerous buildings. Otherwise, it is "No".                                                                                                                                     |                                     |
| total_assessment                      | delinquencies         | float     | Total property assessment.                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     |                                     |
| total_due                             | delinquencies         | float     | Total amount owed.                                                                   |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     |                                     |
| tree_canopy_gap                       | tree_canopy           | float     | The amount of tree canopy lacking.                                                   |                                                                                   | https://national-tes-data-share.s3.amazonaws.com/national_tes_share/pa.zip.zip                                                                                  | Adds tree canopy gap information to the primary feature layer by downloading, processing, and spatially joining tree canopy data for Philadelphia County.                                                                                                                                                                                                                                                               |                                     |
| unsafe_building                       | unsafe_buildings      | str       | Indicates whether each property is categorized as an unsafe building ("Y" or "N").   |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Adds unsafe building information to the primary feature layer by joining with a dataset of unsafe buildings.                                                                                                                                                                                                                                                                                                            |                                     |
| vacant                                | vacant_properties     | bool      | Indicates whether the property is vacant.                                            | - The vacant land data is below the threshold, so backup data is loaded from GCS. |                                                                                                                                                                 | Adds a "vacant" column to the primary feature layer based on vacant property data from ESRI layers and backup data from Google Cloud Storage if necessary.                                                                                                                                                                                                                                                              | community_gardens -> ppr_properties |
| zip_code                              | opa_properties        | str       | The zip code of the property                                                         |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |
| zoning                                | opa_properties        | str       | The zoning of the property                                                           |                                                                                   | https://phl.carto.com/api/v2/sql                                                                                                                                | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 |                                     |

## By Function

| name                  | start_time          | end_time            | duration       | description                                                                                                                                                                                                                                                                                                                                                                                                             | returns                                                                                                                                                               | tagline                                        | columns_added                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | columns_updated                                                                                                     | source                                                                                                                                                          | known_issues                                                                                                                                                                             | primary_feature_layer_columns_referenced                                                       |
| :-------------------- | :------------------ | :------------------ | :------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------ | :-------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------- |
| opa_properties        | 2025-03-20 01:45:03 | 2025-03-20 01:45:38 | 34.72 seconds  | Loads and processes OPA property data, standardizing addresses and cleaning geometries.                                                                                                                                                                                                                                                                                                                                 | FeatureLayer: A feature layer containing processed OPA property data.                                                                                                 | Load OPA data                                  | [{'name': 'opa_id', 'description': 'the OPA ID of the property', 'type': 'int'}, {'name': 'market_value', 'description': 'the market value from the OPA data', 'type': 'float'}, {'name': 'sale_date', 'description': 'the date of the last sale', 'type': 'str'}, {'name': 'sale_price', 'description': 'the price of the last sale', 'type': 'float'}, {'name': 'parcel_type', 'description': '"Land" or "Building"', 'type': 'str'}, {'name': 'zip_code', 'description': 'The zip code of the property', 'type': 'str'}, {'name': 'zoning', 'description': 'The zoning of the property', 'type': 'str'}, {'name': 'owner_1', 'description': 'The first owner of the property', 'type': 'str'}, {'name': 'owner_2', 'description': 'The second owner of the property', 'type': 'str'}, {'name': 'building_code_description', 'description': 'The building code description', 'type': 'str'}, {'name': 'standardized_address', 'description': 'A standardized mailing address', 'type': 'str'}, {'name': 'geometry', 'description': 'The geometry of the property', 'type': 'geometry'}] | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | []                                                                                             |
| vacant_properties     | 2025-03-20 01:45:38 | 2025-03-20 01:46:06 | 27.54 seconds  | Adds a "vacant" column to the primary feature layer based on vacant property data from ESRI layers and backup data from Google Cloud Storage if necessary.                                                                                                                                                                                                                                                              | FeatureLayer: The input feature layer with an added "vacant" column.                                                                                                  | Identify vacant properties.                    | [{'name': 'vacant', 'description': 'Indicates whether the property is vacant.', 'type': 'bool'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | []                                                                                                                  |                                                                                                                                                                 | - The vacant land data is below the threshold, so backup data is loaded from GCS.                                                                                                        | ['opa_id']                                                                                     |
| pwd_parcels           | 2025-03-20 01:46:06 | 2025-03-20 01:46:35 | 28.37 seconds  | Updates the primary feature layer by replacing its geometry column with validated geometries from PWD parcels data. Retains point geometry for rows with no polygon geometry available.                                                                                                                                                                                                                                 | FeatureLayer: The updated primary feature layer with geometries replaced by those from PWD parcels or retained from the original layer if no match.                   | Improve geometry with PWD parcels data.        | []                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | [{'name': 'geometry', 'description': 'The geometry column is updated with validated geometries from PWD parcels.'}] | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| council_dists         | 2025-03-20 01:46:35 | 2025-03-20 01:46:57 | 21.87 seconds  | Associates properties in the primary feature layer with council districts using a spatial join.                                                                                                                                                                                                                                                                                                                         | FeatureLayer: The input feature layer with properties spatially joined to council districts, ensuring no duplicate entries.                                           | Assigns council districts                      | [{'name': 'district', 'description': 'The council district associated with the property.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| nbhoods               | 2025-03-20 01:46:58 | 2025-03-20 01:47:06 | 8.58 seconds   | Adds neighborhood information to the primary feature layer by performing a spatial join with a neighborhoods dataset.                                                                                                                                                                                                                                                                                                   | FeatureLayer: The input feature layer with an added "neighborhood" column, containing the name of the neighborhood for each property.                                 | Assigns neighborhoods                          | [{'name': 'neighborhood', 'description': 'The name of the neighborhood associated with the property.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | []                                                                                                                  | https://raw.githubusercontent.com/opendataphilly/open-geo-data/master/philadelphia-neighborhoods/philadelphia-neighborhoods.geojson                             |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| rco_geoms             | 2025-03-20 01:47:07 | 2025-03-20 01:48:06 | 59.03 seconds  | Adds Registered Community Organization (RCO) information to the primary feature layer by performing a spatial join and aggregating RCO data.                                                                                                                                                                                                                                                                            | FeatureLayer: The input feature layer with added RCO-related columns, including aggregated RCO information and names.                                                 | Assigns Community Org Info                     | [{'name': 'rco_names', 'description': 'Names of RCOs associated with the property.', 'type': 'str'}, {'name': 'rco_info', 'description': 'Additional RCO-related information.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | []                                                                                                                  | "https://services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/Zoning_RCO/FeatureServer/0/"                                                                 |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| city_owned_properties | 2025-03-20 01:48:06 | 2025-03-20 01:48:25 | 18.64 seconds  | Processes city-owned property data by joining it with the primary feature layer, renaming columns, and updating access information for properties based on ownership. All instances where the "city_owner_agency" is "PLB" are changed to "Land Bank (PHDC)".                                                                                                                                                           | FeatureLayer: The updated primary feature layer with processed city ownership information.                                                                            | Categorizes City Owned Properties              | [{'name': 'city_owner_agency', 'description': 'The agency that owns the city property.', 'type': 'str'}, {'name': 'side_yard_eligible', 'description': 'Indicates if the property is eligible for the side yard program.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | []                                                                                                                  | https://services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/LAMAAssets/FeatureServer/0/                                                                   |                                                                                                                                                                                          | ['opa_id', 'owner_1', 'owner2']                                                                |
| phs_properties        | 2025-03-20 01:48:25 | 2025-03-20 01:48:56 | 30.57 seconds  | Perform a spatial join between the primary feature layer and the PHS properties layer, then update the primary feature layer with a new column 'phs_care_program' indicating if the property is part of the PHS care program.                                                                                                                                                                                           | FeatureLayer: The updated primary feature layer with the 'phs_care_program' column.                                                                                   | Identifies PHS Care properties                 | [{'name': 'phs_care_program', 'description': 'The PHS care program associated with the property.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| community_gardens     | 2025-03-20 01:48:57 | 2025-03-20 01:48:59 | 2.13 seconds   | Updates the 'vacant' column in the primary feature layer to ensure community gardens are marked as not vacant. This protects known community gardens from being categorized as vacant, preventing potential predatory development.                                                                                                                                                                                      | FeatureLayer: The input feature layer with the 'vacant' column updated to False for parcels containing community gardens.                                             | Mark Community Gardens as Not Vacant           | []                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | [{'name': 'vacant', 'description': 'Updated to False for parcels containing community gardens.'}]                   | https://services2.arcgis.com/qjOOiLCYeUtwT7x7/arcgis/rest/services/PHS_NGT_Supported_Current_view/FeatureServer/0/                                              |                                                                                                                                                                                          | ['opa_id', 'vacant']                                                                           |
| ppr_properties        | 2025-03-20 01:49:00 | 2025-03-20 01:49:11 | 11.08 seconds  | Updates the 'vacant' column in the primary feature layer to ensure PPR properties are marked as not vacant. This prevents PPR properties from being miscategorized as vacant.                                                                                                                                                                                                                                           | FeatureLayer: The updated primary feature layer.                                                                                                                      | Mark Parks as Not Vacant                       | []                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | [{'name': 'vacant', 'description': 'Updated to False for PPR properties.'}]                                         | https://services.arcgis.com/fLeGjb7u4uXqeF9q/ArcGIS/rest/services/PPR_Properties/FeatureServer/0                                                                | If the Ersi REST URL is not available the function will fall back to loading the data from a GeoJSON URL https://opendata.arcgis.com/datasets/d52445160ab14380a673e5849203eb64_0.geojson | ['opa_id', 'geometry', 'vacant', 'public_name']                                                |
| owner_type            | 2025-03-20 01:49:12 | 2025-03-20 01:49:29 | 17.75 seconds  | Determines the ownership type for each property in the primary feature layer based on the 'owner_1', 'owner_2', and 'city_owner_agency' columns. The ownership type is set as: - "Public" if 'city_owner_agency' is not NA. - "Business (LLC)" if 'city_owner_agency' is NA and "LLC" is found in 'owner_1' or 'owner_2'. - "Individual" if 'city_owner_agency' is NA and "LLC" is not found in 'owner_1' or 'owner_2'. | FeatureLayer: The updated feature layer with the 'owner_type' column added.                                                                                           | Assigns ownership types                        | [{'name': 'owner_type', 'description': 'The ownership type of the property: Public, Business (LLC) or Individual.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['opa_id', 'owner_1', 'owner_2', 'city_owner_agency']                                          |
| li_violations         | 2025-03-20 01:49:31 | 2025-03-20 01:49:38 | 7.11 seconds   | Process L&I (Licenses and Inspections) data for violations. This function filters and processes L&I violations data, joining it with the primary feature layer based on spatial relationships and OPA (Office of Property Assessment) identifiers.                                                                                                                                                                      | FeatureLayer: The primary feature layer updated with L&I data.                                                                                                        | Counts L&I violations                          | [{'name': 'all_violations_past_year', 'description': 'Total violations in the past year.', 'type': 'int'}, {'name': 'open_violations_past_year', 'description': 'Open violations in the past year.', 'type': 'int'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['opa_id']                                                                                     |
| li_complaints         | 2025-03-20 01:49:38 | 2025-03-20 02:00:23 | 645.06 seconds | Applies kernel density estimation (KDE) analysis for L&I complaints to the primary feature layer.                                                                                                                                                                                                                                                                                                                       | FeatureLayer: The input feature layer with KDE analysis results for L&I complaints, including density and derived metrics.                                            | Analyzes L&I complaint density                 | [{'name': 'l_and_i_complaints_density', 'description': 'KDE density of complaints.', 'type': 'float'}, {'name': 'l_and_i_complaints_density_zscore', 'description': 'Z-score of complaint density.', 'type': 'float'}, {'name': 'l_and_i_complaints_density_label', 'description': 'Categorized density level.', 'type': 'str'}, {'name': 'l_and_i_complaints_density_percentile', 'description': 'Percentile rank of density.', 'type': 'float'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['geometry']                                                                                   |
| tree_canopy           | 2025-03-20 02:00:25 | 2025-03-20 02:00:37 | 12.59 seconds  | Adds tree canopy gap information to the primary feature layer by downloading, processing, and spatially joining tree canopy data for Philadelphia County.                                                                                                                                                                                                                                                               | FeatureLayer: The input feature layer with an added "tree_canopy_gap" column indicating the tree canopy gap for each property.                                        | Measures tree canopy gaps.                     | [{'name': 'tree_canopy_gap', 'description': 'The amount of tree canopy lacking.', 'type': 'float'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | []                                                                                                                  | https://national-tes-data-share.s3.amazonaws.com/national_tes_share/pa.zip.zip                                                                                  |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| gun_crimes            | 2025-03-20 02:00:38 | 2025-03-20 02:01:12 | 34.15 seconds  | Applies kernel density estimation (KDE) analysis for gun crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                           | FeatureLayer: The input feature layer with KDE analysis results for gun crimes.                                                                                       | Analyzes gun crime density                     | [{'name': 'gun_crimes_density', 'description': 'KDE density of gun crimes.', 'type': 'float'}, {'name': 'gun_crimes_density_zscore', 'description': 'Z-score of gun crime density.', 'type': 'float'}, {'name': 'gun_crimes_density_label', 'description': 'Categorized density level.', 'type': 'str'}, {'name': 'gun_crimes_density_percentile', 'description': 'Percentile rank of density.', 'type': 'float'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['geometry']                                                                                   |
| drug_crimes           | 2025-03-20 02:01:13 | 2025-03-20 02:01:47 | 33.43 seconds  | Applies kernel density estimation (KDE) analysis for drug crimes to the primary feature layer.                                                                                                                                                                                                                                                                                                                          | FeatureLayer: The input feature layer with KDE analysis results for drug crimes.                                                                                      | Density analysis for drug crimes               | [{'name': 'drug_crimes_density', 'description': 'KDE density of drug crimes.', 'type': 'float'}, {'name': 'drug_crimes_density_zscore', 'description': 'Z-score of drug crime density.', 'type': 'float'}, {'name': 'drug_crimes_density_label', 'description': 'Categorized density level.', 'type': 'str'}, {'name': 'drug_crimes_density_percentile', 'description': 'Percentile rank of density.', 'type': 'float'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['geometry']                                                                                   |
| delinquencies         | 2025-03-20 02:01:49 | 2025-03-20 02:01:58 | 9.18 seconds   | Adds property tax delinquency information to the primary feature layer by joining with a tax delinquencies dataset.                                                                                                                                                                                                                                                                                                     | FeatureLayer: The input feature layer with added columns for tax delinquency information, including total due, actionable status, payment agreements, and more.       | Summarize tax delinquencies                    | [{'name': 'total_due', 'description': 'Total amount owed.', 'type': 'float'}, {'name': 'most_recent_year_owed', 'description': 'Most recent year owed.', 'type': 'str'}, {'name': 'num_years_owed', 'description': 'Number of years owed.', 'type': 'int'}, {'name': 'payment_agreement', 'description': 'Indicates if there is a payment agreement.', 'type': 'str'}, {'name': 'is_actionable', 'description': 'Flag for actionable tax delinquency.', 'type': 'str'}, {'name': 'sheriff_sale', 'description': 'Indicates if the property is at risk of sheriff sale.', 'type': 'str'}, {'name': 'total_assessment', 'description': 'Total property assessment.', 'type': 'float'}]                                                                                                                                                                                                                                                                                                                                                                                                      | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['opa_id']                                                                                     |
| unsafe_buildings      | 2025-03-20 02:02:00 | 2025-03-20 02:02:06 | 5.77 seconds   | Adds unsafe building information to the primary feature layer by joining with a dataset of unsafe buildings.                                                                                                                                                                                                                                                                                                            | FeatureLayer: The input feature layer with an added "unsafe_building" column, indicating whether each property is categorized as an unsafe building ("Y" or "N").     | Identify unsafe buildings                      | [{'name': 'unsafe_building', 'description': 'Indicates whether each property is categorized as an unsafe building ("Y" or "N").', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['oda_id']                                                                                     |
| imm_dang_buildings    | 2025-03-20 02:02:06 | 2025-03-20 02:02:11 | 4.83 seconds   | Adds information about imminently dangerous buildings to the primary feature layer by joining with a dataset of dangerous buildings.                                                                                                                                                                                                                                                                                    | FeatureLayer: The input feature layer with an added "imm_dang_building" column, indicating whether each property is categorized as imminently dangerous ("Y" or "N"). | Identify imminently dangerous buildings        | [{'name': 'imm_dang_building', 'description': 'Indicates whether each property is categorized as imminently dangerous ("Y" or "N").', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['opa_id']                                                                                     |
| contig_neighbors      | 2025-03-20 02:02:12 | 2025-03-20 02:02:14 | 1.66 seconds   | Calculates the number of contiguous vacant neighbors for each property in a feature layer.                                                                                                                                                                                                                                                                                                                              | FeatureLayer: The input feature layer with an added "n_contiguous" column indicating the number of contiguous vacant neighbors for each property.                     | Count vacant neighbors                         | [{'name': 'n_contiguous', 'description': 'The number of contiguous vacant neighbors for each property.', 'type': 'int'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['opa_id', 'vacant']                                                                           |
| dev_probability       | 2025-03-20 02:02:15 | 2025-03-20 02:02:31 | 15.98 seconds  | Calculates development probability based on permit counts and assigns development ranks to census block groups. The results are joined to the primary feature layer.                                                                                                                                                                                                                                                    | FeatureLayer: The input feature layer with added spatial join data for development probability and ranks.                                                             | Calculate development probability              | [{'name': 'permit_count', 'description': 'The number of permits issued in the census block group.', 'type': 'int'}, {'name': 'dev_rank', 'description': 'The development rank of the census block group.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | []                                                                                                                  | https://phl.carto.com/api/v2/sql                                                                                                                                |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| negligent_devs        | 2025-03-20 02:02:32 | 2025-03-20 02:02:34 | 2.05 seconds   | Identifies negligent developers based on the number of vacant properties owned and flags them in the primary feature layer.                                                                                                                                                                                                                                                                                             | FeatureLayer: The input feature layer with additional columns for total properties owned, vacant properties owned, and a "negligent_dev" flag.                        | Identify negligent developers                  | [{'name': 'negligent_dev', 'description': 'non-city owned entities owning 5+ vacant properties', 'type': 'bool'}, {'name': 'n_total_properties_owned', 'description': 'Total number of properties owned by the developer', 'type': 'int'}, {'name': 'n_vacant_properties_owned', 'description': 'Number of vacant properties owned by the developer', 'type': 'int'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['opa_id', 'vacant', 'city_owner_agency', 'standardized_address']                              |
| tactical_urbanism     | 2025-03-20 02:02:34 | 2025-03-20 02:02:50 | 15.94 seconds  | Assigns a 'tactical_urbanism' value to each row in the primary feature layer based on specific conditions. Tactical urbanism is marked as "Yes" if the property is a parcel of type 'Land', and does not have any unsafe or immediately dangerous buildings. Otherwise, it is "No".                                                                                                                                     | The input FeatureLayer with a new column 'tactical_urbanism' added to its GeoDataFrame.                                                                               | Identify tactical urbanism-eligible properties | [{'name': 'tactical_urbanism', 'description': 'Indicates whether each property qualifies for tactical urbanism ("Yes" or "No").', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['parcel_type', 'unsafe_building', 'imm_dang_building']                                        |
| conservatorship       | 2025-03-20 02:02:53 | 2025-03-20 02:03:47 | 53.97 seconds  | Determines conservatorship eligibility for properties in a feature layer.                                                                                                                                                                                                                                                                                                                                               | FeatureLayer: The input feature layer with an added "conservatorship" column indicating whether each property qualifies for conservatorship ("Yes" or "No").          | Identify conservatorship-eligible properties   | [{'name': 'conservatorship', 'description': 'Indicates whether each property qualifies for conservatorship ("Yes" or "No").', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['city_owner_agency', 'sheriff_sale', 'market_value', 'all_violations_past_year', 'sale_date'] |
| park_priority         | 2025-03-20 02:03:49 | 2025-03-20 02:04:04 | 14.62 seconds  | Downloads and processes park priority data, then joins it with the primary feature layer.                                                                                                                                                                                                                                                                                                                               | FeatureLayer: The primary feature layer with park priority data joined.                                                                                               | Labels high-priority park areas.               | [{'name': 'park_priority', 'description': 'The park priority score.', 'type': 'int'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | []                                                                                                                  | https://www.tpl.org/park-data-downloads                                                                                                                         |                                                                                                                                                                                          | ['opa_id', 'geometry']                                                                         |
| priority_level        | 2025-03-20 02:04:04 | 2025-03-20 02:04:25 | 20.22 seconds  | Determines priority levels for properties based on gun crime density, violations, tree canopy gaps, and PHS Landcare status.                                                                                                                                                                                                                                                                                            | FeatureLayer: The input feature layer with an added "priority_level" column, indicating the priority for each property as "Low", "Medium", or "High".                 | Add priority levels                            | [{'name': 'priority_level', 'description': 'The priority level ( "Low", "Medium", or "High") of the property', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | []                                                                                                                  | gun_crimes_density_zscore, all_violations_past_year, l_and_i_complaints_density_zscore, tree_canopy_gap, phs_care_program columns in the primary feature layer. |                                                                                                                                                                                          | []                                                                                             |
| access_process        | 2025-03-20 02:04:27 | 2025-03-20 02:04:45 | 17.99 seconds  | Process a dataset to determine the access process for each property based on city ownership and market value. The result is added as a new column in the dataset.                                                                                                                                                                                                                                                       | Any: The updated dataset with an additional "access_process" column.                                                                                                  | Assigns access processes                       | [{'name': 'access_process', 'description': 'The access process for each property based on city ownership and market value.', 'type': 'str'}]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | []                                                                                                                  |                                                                                                                                                                 |                                                                                                                                                                                          | ['city_owner_agency', 'market_value']                                                          |
